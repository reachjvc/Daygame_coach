{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "waiver.schema.json",
  "title": "Validation Waiver File",
  "description": "Explicit validation waivers for known exceptions in manifest validation.",
  "oneOf": [
    { "$ref": "#/$defs/object_form" },
    { "$ref": "#/$defs/array_form" }
  ],
  "$defs": {
    "waiver_item": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "video_id": {
          "type": "string",
          "pattern": "^(\\*|[A-Za-z0-9_-]{11})$",
          "description": "YouTube video id or '*' wildcard."
        },
        "check": {
          "type": "string",
          "minLength": 1,
          "description": "Validation check id or '*' wildcard."
        },
        "note": {
          "type": "string",
          "description": "Optional human context for the waiver."
        },
        "expires_at": {
          "type": "string",
          "description": "Optional ISO timestamp for waiver expiry."
        }
      },
      "required": ["video_id", "check"]
    },
    "object_form": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "waivers": {
          "type": "array",
          "items": { "$ref": "#/$defs/waiver_item" }
        }
      },
      "required": ["waivers"]
    },
    "array_form": {
      "type": "array",
      "items": { "$ref": "#/$defs/waiver_item" }
    }
  }
}
